% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/xCell2Train.R
\name{xCell2Train}
\alias{xCell2Train}
\title{xCell2Train function}
\usage{
xCell2Train(
  ref,
  labels,
  mix = NULL,
  ref_type,
  filtering_data = NULL,
  lineage_file = NULL,
  top_genes_frac = 1,
  medianGEP = TRUE,
  seed = 123,
  probs = c(0.01, 0.05, 0.1, 0.15, 0.2, 0.25, 0.3, 0.4),
  sim_fracs = c(0, seq(0.01, 0.25, 0.01), seq(0.3, 1, 0.05)),
  diff_vals = round(c(log2(1), log2(1.5), log2(2), log2(2.5), log2(3), log2(4), log2(5),
    log2(10), log2(20)), 3),
  min_genes = 3,
  max_genes = 150,
  return_sigs = FALSE,
  return_sigs_filt = FALSE,
  sigsFile = NULL,
  minPBcells = 30,
  minPBsamples = 10,
  ct_sims = 50,
  samples_frac = 0.1,
  simMethod = "ref_multi",
  nCores = 1,
  top_sigs_frac = 0.05
)
}
\arguments{
\item{ref}{A reference gene expression matrix.}

\item{labels}{A data frame in which the rows correspond to samples in the ref. The data frame must have four columns:
"ont": the cell type ontology as a character (i.e., "CL:0000545" or NA if there is no ontology).
"label": the cell type name as a character (i.e., "T-helper 1 cell").
"sample": the cell type sample should match the column name in ref.
"dataset": the cell type sample dataset or subject (for single-cell) as a character.}

\item{mix}{description}

\item{ref_type}{Gene expression data type: "rnaseq", "array", or "sc".}

\item{filtering_data}{description}

\item{lineage_file}{Path to the cell type lineage file generated with `xCell2GetLineage` function (optional).}

\item{top_genes_frac}{description}

\item{probs}{A vector of probability thresholds to be used for generating signatures (optional).}

\item{sim_fracs}{A vector of mixture fractions to be used in signature filtering (optional).}

\item{diff_vals}{A vector of delta values to be used for generating signatures (optional).}

\item{min_genes}{The minimum number of genes to include in the signature (optional).}

\item{max_genes}{The maximum number of genes to include in the signature (optional).}

\item{return_sigs}{description}

\item{return_sigs_filt}{description}

\item{sigsFile}{description}

\item{minPBcells}{description}

\item{ct_sims}{description}

\item{samples_frac}{description}

\item{simMethod}{description}

\item{nCores}{description}

\item{top_sigs_frac}{description}

\item{mix_type}{Gene expression data type: "rnaseq", "array", or "sc".}

\item{minPBgroups}{description}
}
\value{
An S4 object containing the signatures, cell type labels, and cell type dependencies.
}
\description{
This function generates signatures for each cell type.
}
